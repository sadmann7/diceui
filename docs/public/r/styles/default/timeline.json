{
  "name": "timeline",
  "type": "registry:ui",
  "dependencies": [
    "@radix-ui/react-slot",
    "class-variance-authority"
  ],
  "files": [
    {
      "path": "ui/timeline.tsx",
      "content": "\"use client\";\n\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva } from \"class-variance-authority\";\nimport * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ntype Direction = \"ltr\" | \"rtl\";\ntype Orientation = \"vertical\" | \"horizontal\";\n\ninterface DivProps extends React.ComponentProps<\"div\"> {\n  asChild?: boolean;\n}\n\nconst ROOT_NAME = \"Timeline\";\nconst ITEM_NAME = \"TimelineItem\";\nconst DOT_NAME = \"TimelineDot\";\nconst CONNECTOR_NAME = \"TimelineConnector\";\n\nconst useIsomorphicLayoutEffect =\n  typeof window === \"undefined\" ? React.useEffect : React.useLayoutEffect;\n\nconst DirectionContext = React.createContext<Direction | undefined>(undefined);\n\nfunction useDirection(dirProp?: Direction): Direction {\n  const contextDir = React.useContext(DirectionContext);\n  return dirProp ?? contextDir ?? \"ltr\";\n}\n\nfunction useLazyRef<T>(fn: () => T) {\n  const ref = React.useRef<T | null>(null);\n\n  if (ref.current === null) {\n    ref.current = fn();\n  }\n\n  return ref as React.RefObject<T>;\n}\n\ninterface ItemState {\n  completed: boolean;\n  ref: React.RefObject<HTMLLIElement | null>;\n}\n\ninterface StoreState {\n  items: Map<string, ItemState>;\n}\n\ninterface Store {\n  subscribe: (callback: () => void) => () => void;\n  getState: () => StoreState;\n  notify: () => void;\n  onItemRegister: (\n    id: string,\n    completed: boolean,\n    ref: React.RefObject<HTMLLIElement | null>,\n  ) => void;\n  onItemUnregister: (id: string) => void;\n  getNextItemCompleted: (id: string) => boolean | undefined;\n  getItemIndex: (id: string) => number;\n}\n\nconst StoreContext = React.createContext<Store | null>(null);\n\nfunction useStoreContext(consumerName: string) {\n  const context = React.useContext(StoreContext);\n  if (!context) {\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${ROOT_NAME}\\``);\n  }\n  return context;\n}\n\ninterface TimelineContextValue {\n  dir: Direction;\n  orientation: Orientation;\n  variant: \"default\" | \"alternate\";\n}\n\nconst TimelineContext = React.createContext<TimelineContextValue | null>(null);\n\nfunction useTimelineContext(consumerName: string) {\n  const context = React.useContext(TimelineContext);\n  if (!context) {\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${ROOT_NAME}\\``);\n  }\n  return context;\n}\n\nconst timelineVariants = cva(\"relative flex list-none\", {\n  variants: {\n    orientation: {\n      vertical: \"flex-col gap-6\",\n      horizontal: \"flex-row items-start gap-8\",\n    },\n  },\n  defaultVariants: {\n    orientation: \"vertical\",\n  },\n});\n\ninterface TimelineRootProps extends React.ComponentProps<\"ol\"> {\n  dir?: Direction;\n  orientation?: Orientation;\n  variant?: \"default\" | \"alternate\";\n  asChild?: boolean;\n}\n\nfunction TimelineRoot(props: TimelineRootProps) {\n  const {\n    orientation = \"vertical\",\n    variant = \"default\",\n    dir: dirProp,\n    asChild,\n    className,\n    ...rootProps\n  } = props;\n\n  const dir = useDirection(dirProp);\n\n  const listenersRef = useLazyRef(() => new Set<() => void>());\n  const stateRef = useLazyRef<StoreState>(() => ({\n    items: new Map(),\n  }));\n\n  const store = React.useMemo<Store>(() => {\n    return {\n      subscribe: (cb) => {\n        listenersRef.current.add(cb);\n        return () => listenersRef.current.delete(cb);\n      },\n      getState: () => stateRef.current,\n      notify: () => {\n        for (const cb of listenersRef.current) {\n          cb();\n        }\n      },\n      onItemRegister: (\n        id: string,\n        completed: boolean,\n        ref: React.RefObject<HTMLLIElement | null>,\n      ) => {\n        stateRef.current.items.set(id, { completed, ref });\n        store.notify();\n      },\n      onItemUnregister: (id: string) => {\n        stateRef.current.items.delete(id);\n        store.notify();\n      },\n      getNextItemCompleted: (id: string) => {\n        const entries = Array.from(stateRef.current.items.entries());\n\n        const sortedEntries = entries.sort((a, b) => {\n          const elementA = a[1].ref.current;\n          const elementB = b[1].ref.current;\n          if (!elementA || !elementB) return 0;\n          const position = elementA.compareDocumentPosition(elementB);\n          if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n            return -1;\n          }\n          if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n            return 1;\n          }\n          return 0;\n        });\n\n        const currentIndex = sortedEntries.findIndex(([key]) => key === id);\n        if (currentIndex === -1 || currentIndex === sortedEntries.length - 1) {\n          return undefined;\n        }\n        const nextEntry = sortedEntries[currentIndex + 1];\n        return nextEntry ? nextEntry[1].completed : undefined;\n      },\n      getItemIndex: (id: string) => {\n        const entries = Array.from(stateRef.current.items.entries());\n\n        const sortedEntries = entries.sort((a, b) => {\n          const elementA = a[1].ref.current;\n          const elementB = b[1].ref.current;\n          if (!elementA || !elementB) return 0;\n          const position = elementA.compareDocumentPosition(elementB);\n          if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n            return -1;\n          }\n          if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n            return 1;\n          }\n          return 0;\n        });\n\n        return sortedEntries.findIndex(([key]) => key === id);\n      },\n    };\n  }, [listenersRef, stateRef]);\n\n  const contextValue = React.useMemo<TimelineContextValue>(\n    () => ({\n      dir,\n      orientation,\n      variant,\n    }),\n    [dir, orientation, variant],\n  );\n\n  const RootPrimitive = asChild ? Slot : \"ol\";\n\n  return (\n    <StoreContext.Provider value={store}>\n      <TimelineContext.Provider value={contextValue}>\n        <RootPrimitive\n          aria-orientation={orientation}\n          data-orientation={orientation}\n          data-variant={variant}\n          data-slot=\"timeline\"\n          dir={dir}\n          {...rootProps}\n          className={cn(\n            timelineVariants({ orientation }),\n            variant === \"alternate\" &&\n              orientation === \"vertical\" &&\n              \"relative w-full gap-0\",\n            variant === \"alternate\" &&\n              orientation === \"horizontal\" &&\n              \"items-center gap-x-8 gap-y-0\",\n            className,\n          )}\n        />\n      </TimelineContext.Provider>\n    </StoreContext.Provider>\n  );\n}\n\ninterface TimelineItemContextValue {\n  id: string;\n  completed: boolean;\n  isAlternateRight: boolean;\n}\n\nconst TimelineItemContext =\n  React.createContext<TimelineItemContextValue | null>(null);\n\nfunction useTimelineItemContext(consumerName: string) {\n  const context = React.useContext(TimelineItemContext);\n  if (!context) {\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${ITEM_NAME}\\``);\n  }\n  return context;\n}\n\ninterface TimelineItemProps extends React.ComponentProps<\"li\"> {\n  completed?: boolean;\n  asChild?: boolean;\n}\n\nfunction TimelineItem(props: TimelineItemProps) {\n  const { completed = false, asChild, className, ...itemProps } = props;\n\n  const { dir, orientation, variant } = useTimelineContext(ITEM_NAME);\n  const store = useStoreContext(ITEM_NAME);\n  const id = React.useId();\n  const itemRef = React.useRef<HTMLLIElement>(null);\n\n  useIsomorphicLayoutEffect(() => {\n    store.onItemRegister(id, completed, itemRef);\n    return () => {\n      store.onItemUnregister(id);\n    };\n  }, [id, completed, store]);\n\n  const getSnapshot = React.useCallback(() => {\n    return store.getItemIndex(id);\n  }, [id, store]);\n\n  const itemIndex = React.useSyncExternalStore(\n    store.subscribe,\n    getSnapshot,\n    getSnapshot,\n  );\n\n  const isAlternateRight = variant === \"alternate\" && itemIndex % 2 === 1;\n\n  const itemContextValue = React.useMemo<TimelineItemContextValue>(\n    () => ({ id, completed, isAlternateRight }),\n    [id, completed, isAlternateRight],\n  );\n\n  const ItemPrimitive = asChild ? Slot : \"li\";\n\n  return (\n    <TimelineItemContext.Provider value={itemContextValue}>\n      <ItemPrimitive\n        ref={itemRef}\n        data-slot=\"timeline-item\"\n        data-completed={completed ? \"\" : undefined}\n        data-orientation={orientation}\n        data-alternate-right={isAlternateRight ? \"\" : undefined}\n        dir={dir}\n        {...itemProps}\n        className={cn(\n          \"relative flex\",\n          orientation === \"vertical\" &&\n            variant === \"default\" &&\n            \"gap-3 pb-8 last:pb-0\",\n          orientation === \"horizontal\" &&\n            variant === \"default\" &&\n            \"flex-col gap-3\",\n          orientation === \"vertical\" &&\n            variant === \"alternate\" &&\n            !isAlternateRight &&\n            \"w-1/2 gap-3 pr-8 pb-12 last:pb-0\",\n          orientation === \"vertical\" &&\n            variant === \"alternate\" &&\n            isAlternateRight &&\n            \"ml-auto w-1/2 flex-row-reverse gap-3 pb-12 pl-8 last:pb-0\",\n          orientation === \"horizontal\" &&\n            variant === \"alternate\" &&\n            \"grid min-w-0 grid-rows-[1fr_auto_1fr] gap-3\",\n          className,\n        )}\n      />\n    </TimelineItemContext.Provider>\n  );\n}\n\ninterface TimelineDotProps extends DivProps {\n  asChild?: boolean;\n}\n\nfunction TimelineDot(props: TimelineDotProps) {\n  const { asChild, className, ...dotProps } = props;\n\n  const { orientation, variant } = useTimelineContext(DOT_NAME);\n  const { completed, isAlternateRight } = useTimelineItemContext(DOT_NAME);\n\n  const DotPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <DotPrimitive\n      data-slot=\"timeline-dot\"\n      data-completed={completed ? \"\" : undefined}\n      data-orientation={orientation}\n      {...dotProps}\n      className={cn(\n        \"relative z-10 flex size-3 shrink-0 items-center justify-center rounded-full border-2\",\n        completed\n          ? \"border-primary bg-primary/10\"\n          : \"border-border bg-background\",\n        variant === \"alternate\" &&\n          orientation === \"vertical\" &&\n          !isAlternateRight &&\n          \"-right-[6px] absolute bg-background\",\n        variant === \"alternate\" &&\n          orientation === \"vertical\" &&\n          isAlternateRight &&\n          \"-left-[6px] absolute bg-background\",\n        variant === \"alternate\" &&\n          orientation === \"horizontal\" &&\n          \"row-start-2 bg-background\",\n        variant === \"alternate\" && completed && \"bg-background\",\n        className,\n      )}\n    />\n  );\n}\n\ninterface TimelineConnectorProps extends DivProps {\n  asChild?: boolean;\n  forceMount?: boolean;\n}\n\nfunction TimelineConnector(props: TimelineConnectorProps) {\n  const { asChild, forceMount, className, ...connectorProps } = props;\n\n  const { orientation, variant } = useTimelineContext(CONNECTOR_NAME);\n  const store = useStoreContext(CONNECTOR_NAME);\n  const { id, completed, isAlternateRight } =\n    useTimelineItemContext(CONNECTOR_NAME);\n\n  const getSnapshot = React.useCallback(() => {\n    return store.getNextItemCompleted(id);\n  }, [id, store]);\n\n  const nextCompleted = React.useSyncExternalStore(\n    store.subscribe,\n    getSnapshot,\n    getSnapshot,\n  );\n\n  const isLastItem = nextCompleted === undefined;\n\n  if (!forceMount && isLastItem) return null;\n\n  const isConnectorCompleted = completed && nextCompleted;\n\n  const ConnectorPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <ConnectorPrimitive\n      aria-hidden=\"true\"\n      data-slot=\"timeline-connector\"\n      data-completed={isConnectorCompleted ? \"\" : undefined}\n      data-orientation={orientation}\n      {...connectorProps}\n      className={cn(\n        \"absolute z-0\",\n        isConnectorCompleted ? \"bg-primary/30\" : \"bg-border\",\n        orientation === \"vertical\" &&\n          variant === \"default\" &&\n          \"start-[5px] top-3 h-[calc(100%+0.5rem)] w-[2px]\",\n        orientation === \"horizontal\" &&\n          variant === \"default\" &&\n          \"start-3 top-[5px] h-[2px] w-[calc(100%+0.5rem)]\",\n        orientation === \"vertical\" &&\n          variant === \"alternate\" &&\n          !isAlternateRight &&\n          \"-right-px top-2 h-full w-[2px]\",\n        orientation === \"vertical\" &&\n          variant === \"alternate\" &&\n          isAlternateRight &&\n          \"-left-px top-2 h-full w-[2px]\",\n        orientation === \"horizontal\" &&\n          variant === \"alternate\" &&\n          \"top-[5px] left-3 row-start-2 h-[2px] w-[calc(100%+0.5rem)]\",\n        className,\n      )}\n    />\n  );\n}\n\ninterface TimelineHeaderProps extends DivProps {\n  asChild?: boolean;\n}\n\nfunction TimelineHeader(props: TimelineHeaderProps) {\n  const { asChild, className, ...headerProps } = props;\n\n  const HeaderPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <HeaderPrimitive\n      data-slot=\"timeline-header\"\n      {...headerProps}\n      className={cn(\"flex flex-col gap-1\", className)}\n    />\n  );\n}\n\ninterface TimelineTitleProps extends DivProps {\n  asChild?: boolean;\n}\n\nfunction TimelineTitle(props: TimelineTitleProps) {\n  const { asChild, className, ...titleProps } = props;\n\n  const TitlePrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <TitlePrimitive\n      data-slot=\"timeline-title\"\n      {...titleProps}\n      className={cn(\"font-semibold leading-none\", className)}\n    />\n  );\n}\n\ninterface TimelineDescriptionProps extends DivProps {\n  asChild?: boolean;\n}\n\nfunction TimelineDescription(props: TimelineDescriptionProps) {\n  const { asChild, className, ...descriptionProps } = props;\n\n  const DescriptionPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <DescriptionPrimitive\n      data-slot=\"timeline-description\"\n      {...descriptionProps}\n      className={cn(\"text-muted-foreground text-sm\", className)}\n    />\n  );\n}\n\ninterface TimelineContentProps extends DivProps {\n  asChild?: boolean;\n}\n\nfunction TimelineContent(props: TimelineContentProps) {\n  const { asChild, className, ...contentProps } = props;\n\n  const { variant, orientation } = useTimelineContext(\"TimelineContent\");\n  const { isAlternateRight } = useTimelineItemContext(\"TimelineContent\");\n\n  const ContentPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <ContentPrimitive\n      data-slot=\"timeline-content\"\n      {...contentProps}\n      className={cn(\n        \"flex-1 pt-0.5\",\n        variant === \"alternate\" &&\n          orientation === \"vertical\" &&\n          !isAlternateRight &&\n          \"text-right\",\n        variant === \"alternate\" &&\n          orientation === \"horizontal\" &&\n          !isAlternateRight &&\n          \"row-start-3 pt-3\",\n        variant === \"alternate\" &&\n          orientation === \"horizontal\" &&\n          isAlternateRight &&\n          \"row-start-1 pb-3\",\n        className,\n      )}\n    />\n  );\n}\n\ninterface TimelineTimeProps extends React.ComponentProps<\"time\"> {\n  asChild?: boolean;\n}\n\nfunction TimelineTime(props: TimelineTimeProps) {\n  const { asChild, className, ...timeProps } = props;\n\n  const TimePrimitive = asChild ? Slot : \"time\";\n\n  return (\n    <TimePrimitive\n      data-slot=\"timeline-time\"\n      {...timeProps}\n      className={cn(\"text-muted-foreground text-xs\", className)}\n    />\n  );\n}\n\nexport {\n  TimelineRoot as Root,\n  TimelineItem as Item,\n  TimelineDot as Dot,\n  TimelineConnector as Connector,\n  TimelineHeader as Header,\n  TimelineTitle as Title,\n  TimelineDescription as Description,\n  TimelineContent as Content,\n  TimelineTime as Time,\n  //\n  TimelineRoot as Timeline,\n  TimelineItem,\n  TimelineDot,\n  TimelineConnector,\n  TimelineHeader,\n  TimelineTitle,\n  TimelineDescription,\n  TimelineContent,\n  TimelineTime,\n};\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}