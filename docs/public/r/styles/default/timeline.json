{
  "name": "timeline",
  "type": "registry:ui",
  "dependencies": [
    "@radix-ui/react-slot",
    "class-variance-authority"
  ],
  "files": [
    {
      "path": "ui/timeline.tsx",
      "content": "\"use client\";\n\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva } from \"class-variance-authority\";\nimport * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ntype Direction = \"ltr\" | \"rtl\";\ntype Orientation = \"vertical\" | \"horizontal\";\ntype Variant = \"default\" | \"alternate\";\ntype Status = \"completed\" | \"active\" | \"pending\";\n\ninterface DivProps extends React.ComponentProps<\"div\"> {\n  asChild?: boolean;\n}\n\ntype ItemElement = React.ComponentRef<typeof TimelineItem>;\n\nconst ROOT_NAME = \"Timeline\";\nconst ITEM_NAME = \"TimelineItem\";\nconst DOT_NAME = \"TimelineDot\";\nconst CONNECTOR_NAME = \"TimelineConnector\";\nconst CONTENT_NAME = \"TimelineContent\";\n\nconst useIsomorphicLayoutEffect =\n  typeof window === \"undefined\" ? React.useEffect : React.useLayoutEffect;\n\nconst DirectionContext = React.createContext<Direction | undefined>(undefined);\n\nfunction useDirection(dirProp?: Direction): Direction {\n  const contextDir = React.useContext(DirectionContext);\n  return dirProp ?? contextDir ?? \"ltr\";\n}\n\nfunction useLazyRef<T>(fn: () => T) {\n  const ref = React.useRef<T | null>(null);\n\n  if (ref.current === null) {\n    ref.current = fn();\n  }\n\n  return ref as React.RefObject<T>;\n}\n\ninterface ItemState {\n  status: Status;\n  ref: React.RefObject<HTMLDivElement | null>;\n}\n\ninterface StoreState {\n  items: Map<string, ItemState>;\n}\n\ninterface Store {\n  subscribe: (callback: () => void) => () => void;\n  getState: () => StoreState;\n  notify: () => void;\n  onItemRegister: (\n    id: string,\n    status: Status,\n    ref: React.RefObject<ItemElement | null>,\n  ) => void;\n  onItemUnregister: (id: string) => void;\n  getNextItemCompleted: (id: string) => boolean | undefined;\n  getItemIndex: (id: string) => number;\n}\n\nconst StoreContext = React.createContext<Store | null>(null);\n\nfunction useStoreContext(consumerName: string) {\n  const context = React.useContext(StoreContext);\n  if (!context) {\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${ROOT_NAME}\\``);\n  }\n  return context;\n}\n\ninterface TimelineContextValue {\n  dir: Direction;\n  orientation: Orientation;\n  variant: Variant;\n  activeStep?: number;\n}\n\nconst TimelineContext = React.createContext<TimelineContextValue | null>(null);\n\nfunction useTimelineContext(consumerName: string) {\n  const context = React.useContext(TimelineContext);\n  if (!context) {\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${ROOT_NAME}\\``);\n  }\n  return context;\n}\n\nconst timelineVariants = cva(\"relative flex list-none\", {\n  variants: {\n    orientation: {\n      vertical: \"flex-col\",\n      horizontal: \"flex-row items-start\",\n    },\n    variant: {\n      default: \"\",\n      alternate: \"\",\n    },\n  },\n  compoundVariants: [\n    {\n      orientation: \"vertical\",\n      variant: \"default\",\n      class: \"gap-6\",\n    },\n    {\n      orientation: \"horizontal\",\n      variant: \"default\",\n      class: \"gap-8\",\n    },\n    {\n      orientation: \"vertical\",\n      variant: \"alternate\",\n      class: \"relative w-full gap-3\",\n    },\n    {\n      orientation: \"horizontal\",\n      variant: \"alternate\",\n      class: \"items-center gap-6\",\n    },\n  ],\n  defaultVariants: {\n    orientation: \"vertical\",\n    variant: \"default\",\n  },\n});\n\ninterface TimelineRootProps extends React.ComponentProps<\"div\"> {\n  dir?: Direction;\n  orientation?: Orientation;\n  variant?: Variant;\n  activeStep?: number;\n  asChild?: boolean;\n}\n\nfunction TimelineRoot(props: TimelineRootProps) {\n  const {\n    orientation = \"vertical\",\n    variant = \"default\",\n    dir: dirProp,\n    activeStep,\n    asChild,\n    className,\n    ...rootProps\n  } = props;\n\n  const dir = useDirection(dirProp);\n\n  const listenersRef = useLazyRef(() => new Set<() => void>());\n  const stateRef = useLazyRef<StoreState>(() => ({\n    items: new Map(),\n  }));\n\n  const store = React.useMemo<Store>(() => {\n    return {\n      subscribe: (cb) => {\n        listenersRef.current.add(cb);\n        return () => listenersRef.current.delete(cb);\n      },\n      getState: () => stateRef.current,\n      notify: () => {\n        for (const cb of listenersRef.current) {\n          cb();\n        }\n      },\n      onItemRegister: (\n        id: string,\n        status: Status,\n        ref: React.RefObject<ItemElement | null>,\n      ) => {\n        stateRef.current.items.set(id, { status, ref });\n        store.notify();\n      },\n      onItemUnregister: (id: string) => {\n        stateRef.current.items.delete(id);\n        store.notify();\n      },\n      getNextItemCompleted: (id: string) => {\n        const entries = Array.from(stateRef.current.items.entries());\n\n        const sortedEntries = entries.sort((a, b) => {\n          const elementA = a[1].ref.current;\n          const elementB = b[1].ref.current;\n          if (!elementA || !elementB) return 0;\n          const position = elementA.compareDocumentPosition(elementB);\n          if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n            return -1;\n          }\n          if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n            return 1;\n          }\n          return 0;\n        });\n\n        const currentIndex = sortedEntries.findIndex(([key]) => key === id);\n        if (currentIndex === -1 || currentIndex === sortedEntries.length - 1) {\n          return undefined;\n        }\n        const nextEntry = sortedEntries[currentIndex + 1];\n        return nextEntry ? nextEntry[1].status === \"completed\" : undefined;\n      },\n      getItemIndex: (id: string) => {\n        const entries = Array.from(stateRef.current.items.entries());\n\n        const sortedEntries = entries.sort((a, b) => {\n          const elementA = a[1].ref.current;\n          const elementB = b[1].ref.current;\n          if (!elementA || !elementB) return 0;\n          const position = elementA.compareDocumentPosition(elementB);\n          if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n            return -1;\n          }\n          if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n            return 1;\n          }\n          return 0;\n        });\n\n        return sortedEntries.findIndex(([key]) => key === id);\n      },\n    };\n  }, [listenersRef, stateRef]);\n\n  const contextValue = React.useMemo<TimelineContextValue>(\n    () => ({\n      dir,\n      orientation,\n      variant,\n      activeStep,\n    }),\n    [dir, orientation, variant, activeStep],\n  );\n\n  const RootPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <StoreContext.Provider value={store}>\n      <TimelineContext.Provider value={contextValue}>\n        <RootPrimitive\n          role=\"list\"\n          aria-orientation={orientation}\n          data-slot=\"timeline\"\n          data-orientation={orientation}\n          data-variant={variant}\n          dir={dir}\n          {...rootProps}\n          className={cn(timelineVariants({ orientation, variant, className }))}\n        />\n      </TimelineContext.Provider>\n    </StoreContext.Provider>\n  );\n}\n\ninterface TimelineItemContextValue {\n  id: string;\n  status: Status;\n  isAlternateRight: boolean;\n}\n\nconst TimelineItemContext =\n  React.createContext<TimelineItemContextValue | null>(null);\n\nfunction useTimelineItemContext(consumerName: string) {\n  const context = React.useContext(TimelineItemContext);\n  if (!context) {\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${ITEM_NAME}\\``);\n  }\n  return context;\n}\n\nconst timelineItemVariants = cva(\"relative flex\", {\n  variants: {\n    orientation: {\n      vertical: \"\",\n      horizontal: \"\",\n    },\n    variant: {\n      default: \"\",\n      alternate: \"\",\n    },\n    isAlternateRight: {\n      true: \"\",\n      false: \"\",\n    },\n  },\n  compoundVariants: [\n    {\n      orientation: \"vertical\",\n      variant: \"default\",\n      class: \"gap-3 pb-8 last:pb-0\",\n    },\n    {\n      orientation: \"horizontal\",\n      variant: \"default\",\n      class: \"flex-col gap-3\",\n    },\n    {\n      orientation: \"vertical\",\n      variant: \"alternate\",\n      isAlternateRight: false,\n      class: \"w-1/2 gap-3 pr-8 pb-12 last:pb-0\",\n    },\n    {\n      orientation: \"vertical\",\n      variant: \"alternate\",\n      isAlternateRight: true,\n      class: \"ml-auto w-1/2 flex-row-reverse gap-3 pb-12 pl-8 last:pb-0\",\n    },\n    {\n      orientation: \"horizontal\",\n      variant: \"alternate\",\n      class: \"grid min-w-0 grid-rows-[1fr_auto_1fr] gap-3\",\n    },\n  ],\n  defaultVariants: {\n    orientation: \"vertical\",\n    variant: \"default\",\n    isAlternateRight: false,\n  },\n});\n\nfunction TimelineItem(props: DivProps) {\n  const { asChild, className, ...itemProps } = props;\n\n  const { dir, orientation, variant, activeStep } =\n    useTimelineContext(ITEM_NAME);\n  const store = useStoreContext(ITEM_NAME);\n\n  const id = React.useId();\n  const itemRef = React.useRef<ItemElement | null>(null);\n\n  const getSnapshot = React.useCallback(() => {\n    return store.getItemIndex(id);\n  }, [id, store]);\n\n  const itemIndex = React.useSyncExternalStore(\n    store.subscribe,\n    getSnapshot,\n    getSnapshot,\n  );\n\n  const status = React.useMemo<Status>(() => {\n    if (activeStep === undefined) return \"pending\";\n\n    if (itemIndex < activeStep) return \"completed\";\n    if (itemIndex === activeStep) return \"active\";\n    return \"pending\";\n  }, [activeStep, itemIndex]);\n\n  useIsomorphicLayoutEffect(() => {\n    store.onItemRegister(id, status, itemRef);\n    return () => {\n      store.onItemUnregister(id);\n    };\n  }, [id, status, store]);\n\n  const isAlternateRight = variant === \"alternate\" && itemIndex % 2 === 1;\n\n  const itemContextValue = React.useMemo<TimelineItemContextValue>(\n    () => ({ id, status, isAlternateRight }),\n    [id, status, isAlternateRight],\n  );\n\n  const ItemPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <TimelineItemContext.Provider value={itemContextValue}>\n      <ItemPrimitive\n        role=\"listitem\"\n        aria-current={status === \"active\" ? \"step\" : undefined}\n        data-slot=\"timeline-item\"\n        data-status={status}\n        data-orientation={orientation}\n        data-alternate-right={isAlternateRight ? \"\" : undefined}\n        dir={dir}\n        {...itemProps}\n        ref={itemRef}\n        className={cn(\n          timelineItemVariants({\n            orientation,\n            variant,\n            isAlternateRight,\n            className,\n          }),\n        )}\n      />\n    </TimelineItemContext.Provider>\n  );\n}\n\nconst timelineDotVariants = cva(\n  \"relative z-10 flex size-3 shrink-0 items-center justify-center rounded-full border-2\",\n  {\n    variants: {\n      status: {\n        completed: \"border-primary bg-primary/10\",\n        active: \"border-primary bg-primary/10\",\n        pending: \"border-border bg-background\",\n      },\n      orientation: {\n        vertical: \"\",\n        horizontal: \"\",\n      },\n      variant: {\n        default: \"\",\n        alternate: \"\",\n      },\n      isAlternateRight: {\n        true: \"\",\n        false: \"\",\n      },\n    },\n    compoundVariants: [\n      {\n        variant: \"alternate\",\n        orientation: \"vertical\",\n        isAlternateRight: false,\n        class: \"-right-[6px] absolute bg-background\",\n      },\n      {\n        variant: \"alternate\",\n        orientation: \"vertical\",\n        isAlternateRight: true,\n        class: \"-left-[6px] absolute bg-background\",\n      },\n      {\n        variant: \"alternate\",\n        orientation: \"horizontal\",\n        class: \"row-start-2 bg-background\",\n      },\n      {\n        variant: \"alternate\",\n        status: \"completed\",\n        class: \"bg-background\",\n      },\n      {\n        variant: \"alternate\",\n        status: \"active\",\n        class: \"bg-background\",\n      },\n    ],\n    defaultVariants: {\n      status: \"pending\",\n      orientation: \"vertical\",\n      variant: \"default\",\n      isAlternateRight: false,\n    },\n  },\n);\n\nfunction TimelineDot(props: DivProps) {\n  const { asChild, className, ...dotProps } = props;\n\n  const { orientation, variant } = useTimelineContext(DOT_NAME);\n  const { status, isAlternateRight } = useTimelineItemContext(DOT_NAME);\n\n  const DotPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <DotPrimitive\n      data-slot=\"timeline-dot\"\n      data-status={status}\n      data-orientation={orientation}\n      {...dotProps}\n      className={cn(\n        timelineDotVariants({\n          status,\n          orientation,\n          variant,\n          isAlternateRight,\n          className,\n        }),\n      )}\n    />\n  );\n}\n\nconst timelineConnectorVariants = cva(\"absolute z-0\", {\n  variants: {\n    isCompleted: {\n      true: \"bg-primary/30\",\n      false: \"bg-border\",\n    },\n    orientation: {\n      vertical: \"\",\n      horizontal: \"\",\n    },\n    variant: {\n      default: \"\",\n      alternate: \"\",\n    },\n    isAlternateRight: {\n      true: \"\",\n      false: \"\",\n    },\n  },\n  compoundVariants: [\n    {\n      orientation: \"vertical\",\n      variant: \"default\",\n      class: \"start-[5px] top-3 h-[calc(100%+0.5rem)] w-[2px]\",\n    },\n    {\n      orientation: \"horizontal\",\n      variant: \"default\",\n      class: \"start-3 top-[5px] h-[2px] w-[calc(100%+0.5rem)]\",\n    },\n    {\n      orientation: \"vertical\",\n      variant: \"alternate\",\n      isAlternateRight: false,\n      class: \"-right-px top-2 h-full w-[2px]\",\n    },\n    {\n      orientation: \"vertical\",\n      variant: \"alternate\",\n      isAlternateRight: true,\n      class: \"-left-px top-2 h-full w-[2px]\",\n    },\n    {\n      orientation: \"horizontal\",\n      variant: \"alternate\",\n      class: \"top-[5px] left-3 row-start-2 h-[2px] w-[calc(100%+0.5rem)]\",\n    },\n  ],\n  defaultVariants: {\n    isCompleted: false,\n    orientation: \"vertical\",\n    variant: \"default\",\n    isAlternateRight: false,\n  },\n});\n\ninterface TimelineConnectorProps extends DivProps {\n  forceMount?: boolean;\n}\n\nfunction TimelineConnector(props: TimelineConnectorProps) {\n  const { asChild, forceMount, className, ...connectorProps } = props;\n\n  const { orientation, variant } = useTimelineContext(CONNECTOR_NAME);\n  const store = useStoreContext(CONNECTOR_NAME);\n  const { id, status, isAlternateRight } =\n    useTimelineItemContext(CONNECTOR_NAME);\n\n  const getSnapshot = React.useCallback(() => {\n    return store.getNextItemCompleted(id);\n  }, [id, store]);\n\n  const nextCompleted = React.useSyncExternalStore(\n    store.subscribe,\n    getSnapshot,\n    getSnapshot,\n  );\n\n  const isLastItem = nextCompleted === undefined;\n\n  if (!forceMount && isLastItem) return null;\n\n  const isConnectorCompleted = status === \"completed\" && nextCompleted;\n\n  const ConnectorPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <ConnectorPrimitive\n      aria-hidden=\"true\"\n      data-slot=\"timeline-connector\"\n      data-completed={isConnectorCompleted ? \"\" : undefined}\n      data-orientation={orientation}\n      {...connectorProps}\n      className={cn(\n        timelineConnectorVariants({\n          isCompleted: isConnectorCompleted,\n          orientation,\n          variant,\n          isAlternateRight,\n          className,\n        }),\n      )}\n    />\n  );\n}\n\nfunction TimelineHeader(props: DivProps) {\n  const { asChild, className, ...headerProps } = props;\n\n  const HeaderPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <HeaderPrimitive\n      data-slot=\"timeline-header\"\n      {...headerProps}\n      className={cn(\"flex flex-col gap-1\", className)}\n    />\n  );\n}\n\nfunction TimelineTitle(props: DivProps) {\n  const { asChild, className, ...titleProps } = props;\n\n  const TitlePrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <TitlePrimitive\n      data-slot=\"timeline-title\"\n      {...titleProps}\n      className={cn(\"font-semibold leading-none\", className)}\n    />\n  );\n}\n\nfunction TimelineDescription(props: DivProps) {\n  const { asChild, className, ...descriptionProps } = props;\n\n  const DescriptionPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <DescriptionPrimitive\n      data-slot=\"timeline-description\"\n      {...descriptionProps}\n      className={cn(\"text-muted-foreground text-sm\", className)}\n    />\n  );\n}\n\nconst timelineContentVariants = cva(\"flex-1 pt-0.5\", {\n  variants: {\n    orientation: {\n      vertical: \"\",\n      horizontal: \"\",\n    },\n    variant: {\n      default: \"\",\n      alternate: \"\",\n    },\n    isAlternateRight: {\n      true: \"\",\n      false: \"\",\n    },\n  },\n  compoundVariants: [\n    {\n      variant: \"alternate\",\n      orientation: \"vertical\",\n      isAlternateRight: false,\n      class: \"text-right\",\n    },\n    {\n      variant: \"alternate\",\n      orientation: \"horizontal\",\n      isAlternateRight: false,\n      class: \"row-start-3 pt-3\",\n    },\n    {\n      variant: \"alternate\",\n      orientation: \"horizontal\",\n      isAlternateRight: true,\n      class: \"row-start-1 pb-3\",\n    },\n  ],\n  defaultVariants: {\n    orientation: \"vertical\",\n    variant: \"default\",\n    isAlternateRight: false,\n  },\n});\n\nfunction TimelineContent(props: DivProps) {\n  const { asChild, className, ...contentProps } = props;\n\n  const { variant, orientation } = useTimelineContext(CONTENT_NAME);\n  const { status, isAlternateRight } = useTimelineItemContext(CONTENT_NAME);\n\n  const ContentPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <ContentPrimitive\n      data-slot=\"timeline-content\"\n      data-status={status}\n      {...contentProps}\n      className={cn(\n        timelineContentVariants({\n          orientation,\n          variant,\n          isAlternateRight,\n          className,\n        }),\n      )}\n    />\n  );\n}\n\ninterface TimelineTimeProps extends React.ComponentProps<\"time\"> {\n  asChild?: boolean;\n}\n\nfunction TimelineTime(props: TimelineTimeProps) {\n  const { asChild, className, ...timeProps } = props;\n\n  const TimePrimitive = asChild ? Slot : \"time\";\n\n  return (\n    <TimePrimitive\n      data-slot=\"timeline-time\"\n      {...timeProps}\n      className={cn(\"text-muted-foreground text-xs\", className)}\n    />\n  );\n}\n\nexport {\n  TimelineRoot as Root,\n  TimelineItem as Item,\n  TimelineDot as Dot,\n  TimelineConnector as Connector,\n  TimelineHeader as Header,\n  TimelineTitle as Title,\n  TimelineDescription as Description,\n  TimelineContent as Content,\n  TimelineTime as Time,\n  //\n  TimelineRoot as Timeline,\n  TimelineItem,\n  TimelineDot,\n  TimelineConnector,\n  TimelineHeader,\n  TimelineTitle,\n  TimelineDescription,\n  TimelineContent,\n  TimelineTime,\n};\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}